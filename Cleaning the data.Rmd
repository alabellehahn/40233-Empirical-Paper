---
title: "Tidying Consumer Data"
author: "Alana LaBelle-Hahn"
date: "12/9/2021"
output: github_document
---

# Initial Comments

I tried to write a 'for' loop to do this, but it kept throwing me errors,
so I unfortunately have to do it the old fashioned way:

1) Uncropping the summary tables and isolating only the bulk data

2) Fixing up the original excel sheets by renesting the subheaders for the demographic
questions, and removing blank columns and rows. 

then, 

3)Reading in each individual sheet and performing the cleaning and tidying functions
manually...

What a time. 


```{r setup, include=FALSE}
library(tidyverse)
library(dplyr)
library(readxl)
library(lubridate) #Don't think I'll be needing lubridate but leaving it in for now
library(tidyxl)
library(data.table)
library(unpivotr)
library(knitr)
```

# Testing the method for reading in the data and cleaning

```{r }
#Testing out the more technical solution!

# Each cell in the excel file becomes an entire row in R

raw_May2019 <- tidyxl::xlsx_cells(path = "Cuisine Tracker Data_Edited.xlsx", sheet = "May 2019")


#Filter non-blank rows, select variables
raw_May2019 <- raw_May2019 %>%
  dplyr::filter(!is_blank) %>%
  select(row, col, data_type, character, numeric)

# Sorting the data into clear categories
clean_May2019 <- all_cells %>%
  behead("up-left", consumption) %>%
  behead("up", type) %>%
  behead("left-up", question)%>%
  behead("left", demographic) %>%
  rename(n= numeric) %>%
  select(-data_type, -row, -col, -character)

#Removing survey totals from dataframe and creating percentage column
#tidied_data <- tidier[-c(1:2), ] %>%
  #mutate(percentage = mean(n, na.rm= TRUE))
  

```


``` {r, Reading in Aug 2019}

#Attempting to read in sheets from newly edited compilation of sheets

raw_August2019 <- tidyxl::xlsx_cells(path = "Cuisine Tracker Data_Edited.xlsx", sheet = "August 2019")

raw_August2019 <- raw_August2019 %>%
  dplyr::filter(!is_blank) %>%
  select(row, col, data_type, character, numeric)

clean_August2019 <- raw_August2019 %>%
  behead("up-left", consumption) %>%
  behead("up", type) %>%
  behead("left-up", question)%>%
  behead("left", demographic) %>%
  rename(n= numeric) %>%
  select(-data_type, -row, -col, -character)

```


``` {r, Reading in Nov 2019}


raw_November2019 <- tidyxl::xlsx_cells(path = "Cuisine Tracker Data_Edited.xlsx", sheet = "November 2019")

raw_November2019<- raw_November2019 %>%
  dplyr::filter(!is_blank) %>%
  select(row, col, data_type, character, numeric)

clean_November2019 <- raw_November2019 %>%
  behead("up-left", consumption) %>%
  behead("up", type) %>%
  behead("left-up", question)%>%
  behead("left", demographic) %>%
  rename(n= numeric) %>%
  select(-data_type, -row, -col, -character)

```

```{r,  Reading in Feb 2020}


raw_February2020 <- tidyxl::xlsx_cells(path = "Cuisine Tracker Data_Edited.xlsx", sheet = "February 2020")

raw_February2020 <- raw_February2020 %>%
  dplyr::filter(!is_blank) %>%
  select(row, col, data_type, character, numeric)

clean_February2020 <- raw_February2020 %>%
  behead("up-left", consumption) %>%
  behead("up", type) %>%
  behead("left-up", question)%>%
  behead("left", demographic) %>%
  rename(n= numeric) %>%
  select(-data_type, -row, -col, -character)


```

``` {r, Reading in May 2020}

raw_May2020 <- tidyxl::xlsx_cells(path = "Cuisine Tracker Data_Edited.xlsx", sheet = "May 2020")

raw_May2020 <- raw_May2020 %>%
  dplyr::filter(!is_blank) %>%
  select(row, col, data_type, character, numeric)

clean_May2020 <- raw_May2020 %>%
  behead("up-left", consumption) %>%
  behead("up", type) %>%
  behead("left-up", question)%>%
  behead("left", demographic) %>%
  rename(n= numeric) %>%
  select(-data_type, -row, -col, -character)

```


``` {r, Reading in August 2020}

raw_August2020 <- tidyxl::xlsx_cells(path = "Cuisine Tracker Data_Edited.xlsx", sheet = "August 2020")

raw_August2020 <- raw_August2020 %>%
  dplyr::filter(!is_blank) %>%
  select(row, col, data_type, character, numeric)

clean_August2020 <- raw_August2020 %>%
  behead("up-left", consumption) %>%
  behead("up", type) %>%
  behead("left-up", question)%>%
  behead("left", demographic) %>%
  rename(n= numeric) %>%
  select(-data_type, -row, -col, -character)

```

``` {r, Reading in November 2020}

raw_November2020 <- tidyxl::xlsx_cells(path = "Cuisine Tracker Data_Edited.xlsx", sheet = "November 2020")

raw_November2020 <- raw_November2020 %>%
  dplyr::filter(!is_blank) %>%
  select(row, col, data_type, character, numeric)

clean_November2020 <- raw_November2020 %>%
  behead("up-left", consumption) %>%
  behead("up", type) %>%
  behead("left-up", question)%>%
  behead("left", demographic) %>%
  rename(n= numeric) %>%
  select(-data_type, -row, -col, -character)

```



``` {r, Reading in February 2021}

raw_February2021 <- tidyxl::xlsx_cells(path = "Cuisine Tracker Data_Edited.xlsx", sheet = "February 2021")

raw_February2021 <- raw_February2021 %>%
  dplyr::filter(!is_blank) %>%
  select(row, col, data_type, character, numeric)

clean_February2021<- raw_February2021 %>%
  behead("up-left", consumption) %>%
  behead("up", type) %>%
  behead("left-up", question)%>%
  behead("left", demographic) %>%
  rename(n= numeric) %>%
  select(-data_type, -row, -col, -character)

```


``` {r, Reading in May 2021}

raw_May2021 <- tidyxl::xlsx_cells(path = "Cuisine Tracker Data_Edited.xlsx", sheet = "May 2021")

raw_May2021 <- raw_May2021 %>%
  dplyr::filter(!is_blank) %>%
  select(row, col, data_type, character, numeric)

clean_May2021<- raw_May2021 %>%
  behead("up-left", consumption) %>%
  behead("up", type) %>%
  behead("left-up", question)%>%
  behead("left", demographic) %>%
  rename(n= numeric) %>%
  select(-data_type, -row, -col, -character)

```

# Attempting to combine them all

```{r}



```
